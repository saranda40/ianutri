---
import Layout from "../layout/layout.astro";
import "dotenv/config";
import fetch from "node-fetch";

const url = new URL(Astro.request.url);
const params = url.searchParams;

// Obtener los datos del formulario
const nombre = params.get("nombre") || "No proporcionado";
const edad = params.get("edad") || "No especificada";
const peso = parseFloat(params.get("peso") || "0");
const altura = parseFloat(params.get("altura") || "0");
const genero = params.get("genero") || "No especificado";
const enfermedades = params.get("enfermedades") || "Ninguna declarada";
const tratamiento = params.get("tratamiento") || "No";
const email = params.get("email") || "No proporcionado";
const analisis = params.get("analisis") || "No proporcionado";
const imcTexto = params.get("imc") || "No proporcionado";
const Correo = params.get("correo") || "No proporcionado";

---
<Layout title="IAnutri" description="Software de nutrición asociado a IA">
  <main class="px-4">
    <div class="bg-white p-8 rounded-lg shadow-md w-full max-w-md">
      <h1 class="text-2xl font-bold text-center mb-6">
        Análisis de Resultados
      </h1>

      <div class="space-y-2 text-sm">
        <p><strong>Nombre:</strong> {nombre}</p>
        <p><strong>Edad:</strong> {edad}</p>
        <p><strong>Peso:</strong> {peso} kg</p>
        <p><strong>Altura:</strong> {altura} cm</p>
        <p><strong>Género:</strong> {genero}</p>
        <p><strong>Enfermedades:</strong> {enfermedades}</p>
        <p><strong>En tratamiento:</strong> {tratamiento}</p>
        <p><strong>Email:</strong> {email}</p>
        <p><strong>IMC:</strong> {imcTexto}</p>
        <p><strong>Correo:</strong> {Correo}</p>
        <p><strong>Análisis IA:</strong></p>
        <pre
          class="bg-gray-100 p-2 rounded text-xs whitespace-pre-wrap">{analisis}</pre>
      </div>

      <div class="mt-6">
        <a
          href="/"
          class="w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700"
        >
          Volver al Inicio
        </a>
      </div>
    </div>
  </main>
</Layout>